<!DOCTYPE html>
<html>
  <head>
      <link rel='stylesheet' href='/styles/bootstrap.min.css' />
      <link rel='stylesheet' href='/styles/style.css' />
      <script src="/js/jquery-2.2.0.min.js" type="text/javascript"></script>
      <script src="/js/bootstrap.min.js" type="text/javascript"></script>
  </head>
  <body>
    <div>
      <nav class="navbar navbar-inverse" style="padding-left:130px;">
          <ul class="nav navbar-nav">
            <li><a href="/dashboard">Home</a></li>
            <li><a href="/trucks">Trucks</a></li>
          </ul>
      </nav>
    </div>

    <div class="center">
      <h1>Your Cart</h1>
    </div>
    
    <div style="padding-left: 100px; padding-top: 20px; width: 70%;">
      <div id="cartPanel">Loading...</div>
      <div style="margin-top: 20px;">
        <button id="checkoutBtn" class="btn btn-success">Proceed to Checkout</button>
        <button id="clearCartBtn" class="btn btn-danger">Clear Cart</button>
      </div>
    </div>

    <script src="/src/cart.js" type="text/javascript"></script>
    
    <script>
      $(function () {
        loadCart();
        
        $('#clearCartBtn').click(async function () {
          if (!confirm('Are you sure you want to clear your cart?')) {
            return;
          }
          try {
            // Get all cart items and delete them
            const res = await fetch('/api/v1/cart/view');
            const items = await res.json();
            for (let item of items) {
              await fetch('/api/v1/cart/delete/' + item.cartId, { method: 'DELETE' });
            }
            alert('Cart cleared successfully');
            loadCart();
          } catch (err) {
            alert('Error clearing cart: ' + err.message);
          }
        });
      });
    </script>
  </body>
</html>
